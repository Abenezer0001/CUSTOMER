# Order API Test Requests

## Create Order (First User - Maggy)
```bash
curl -v -X POST http://localhost:3001/api/orders \
-H "Content-Type: application/json" \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4MzZlMzM0NWNjYWIxMmJlMDYxNmRhNyIsImVtYWlsIjoiZ29tZXBleGlnQG1haWxpbmF0b3IuY29tIiwicm9sZSI6ImN1c3RvbWVyIiwiaWF0IjoxNzQ4NDI3NTk5LCJleHAiOjE3NDg1MTM5OTl9.1zXH93UEjiFJaHsbjYAU4fPexJBR5z73kIeNsHo_uGg" \
-d '{
  "restaurantId": "65f456b06c9dfd001b6b1234",
  "tableId": "681a58401a12c59b214b39df",
  "items": [{
    "menuItem": "681a58901a12c59b214b3cac",
    "name": "Chocolate Drizzle Popcorn",
    "quantity": 1,
    "price": 30,
    "subtotal": 30,
    "specialInstructions": ""
  }],
  "subtotal": 30,
  "tax": 2.4,
  "tip": 0,
  "total": 33.9,
  "orderType": "DINE_IN",
  "specialInstructions": "",
  "serviceFee": 1.5,
  "status": "PENDING",
  "paymentStatus": "PENDING",
  "orderNumber": "ORD-1748427583808-158",
  "userId": "6836e3345ccab12be0616da7"
}'
```

## Register New User (Test User)
```bash
curl -v -X POST http://localhost:3001/api/customer/register \
-H "Content-Type: application/json" \
-d '{
  "email": "testuser@mailinator.com",
  "password": "Test123!@#",
  "firstName": "Test",
  "lastName": "User"
}'
```

## Create Order (Second User - Test User)
```bash
curl -v -X POST http://localhost:3001/api/orders \
-H "Content-Type: application/json" \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4MzZlOTY3NWNjYWIxMmJlMDYxNmRkOCIsImVtYWlsIjoidGVzdHVzZXJAbWFpbGluYXRvci5jb20iLCJyb2xlIjoiY3VzdG9tZXIiLCJpYXQiOjE3NDg0MjkxNTksImV4cCI6MTc0ODUxNTU1OX0.ECfJFTciMFOzJigJIuFFlz_KlvIl85RDjVC2IAOH8qA" \
-d '{
  "restaurantId": "65f456b06c9dfd001b6b1234",
  "tableId": "681a58401a12c59b214b39df",
  "items": [{
    "menuItem": "681a58901a12c59b214b3cac",
    "name": "Chocolate Drizzle Popcorn",
    "quantity": 2,
    "price": 30,
    "subtotal": 60,
    "specialInstructions": ""
  }],
  "subtotal": 60,
  "tax": 4.8,
  "tip": 0,
  "total": 67.8,
  "orderType": "DINE_IN",
  "specialInstructions": "",
  "serviceFee": 3.0,
  "status": "PENDING",
  "paymentStatus": "PENDING",
  "orderNumber": "ORD-1748429159-123",
  "userId": "6836e9675ccab12be0616dd8"
}'
```

## Get My Orders (First User - Maggy)
```bash
curl -v http://localhost:3001/api/orders/my-orders \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4MzZlMzM0NWNjYWIxMmJlMDYxNmRhNyIsImVtYWlsIjoiZ29tZXBleGlnQG1haWxpbmF0b3IuY29tIiwicm9sZSI6ImN1c3RvbWVyIiwiaWF0IjoxNzQ4NDI3NTk5LCJleHAiOjE3NDg1MTM5OTl9.1zXH93UEjiFJaHsbjYAU4fPexJBR5z73kIeNsHo_uGg"
```

## Get My Orders (Second User - Test User)
```bash
curl -v http://localhost:3001/api/orders/my-orders \
-H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4MzZlOTY3NWNjYWIxMmJlMDYxNmRkOCIsImVtYWlsIjoidGVzdHVzZXJAbWFpbGluYXRvci5jb20iLCJyb2xlIjoiY3VzdG9tZXIiLCJpYXQiOjE3NDg0MjkxNTksImV4cCI6MTc0ODUxNTU1OX0.ECfJFTciMFOzJigJIuFFlz_KlvIl85RDjVC2IAOH8qA"
```

## Test Results Summary

### First User (Maggy)
- Successfully created order (ID: 6836e8fb5ccab12be0616dc0)
- Can view only their own order
- Order total: $33.90 (1 item)

### Second User (Test User)
- Successfully registered
- Successfully created order (ID: 6836e97d5ccab12be0616dda)
- Can view only their own order
- Order total: $67.80 (2 items)

### Notes
- Authentication working correctly
- Order filtering by user working correctly
- Minor issue: restaurantId returns null in responses


## Required Fields
For creating orders, the following fields are required:
- restaurantId
- tableId
- items (array with at least one item)
- status
- paymentStatus
- orderNumber

## Authentication
- Bearer token required for all order endpoints
- Token format: `Bearer <jwt_token>`
- Token contains user ID and role
- Tokens expire after 24 hours

## Common HTTP Status Codes
- 201: Order created successfully
- 200: Orders retrieved successfully
- 401: Invalid or missing authentication
- 400: Missing required fields
- 500: Server error

## Sample Response (Create Order)
```json
{
  "_id": "6836e8fb5ccab12be0616dc0",
  "orderNumber": "250528-8261",
  "restaurantId": null,
  "tableId": {
    "_id": "681a58401a12c59b214b39df",
    "number": "V3T017",
    "fullName": "Venue-undefined - Table V3T017"
  },
  "userId": "6836e3345ccab12be0616da7",
  "items": [{
    "menuItem": "681a58901a12c59b214b3cac",
    "name": "Chocolate Drizzle Popcorn",
    "quantity": 1,
    "price": 30,
    "subtotal": 30
  }],
  "status": "PENDING",
  "paymentStatus": "PENDING",
  "total": 33.90
}
```

## Known Issues
1. restaurantId returns null in responses despite being sent in request
2. Order numbers are auto-generated by server, ignoring client-provided values
3. Table fullName includes "undefined" in response

## TODO
- [ ] Fix restaurantId being null in responses
- [ ] Handle table name formatting better
- [ ] Add pagination to my-orders endpoint
- [ ] Add filtering by date range
